# –§—ñ–Ω–∞–ª—å–Ω–∏–π –ø—Ä–æ—î–∫—Ç –∑ –∫—É—Ä—Å—É

## –ß–∞—Å—Ç–∏–Ω–∞ 1. Building an End-to-End Streaming Pipeline

### –ü–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

     üëâüèª–û—Ç–∂–µ, –≤–∏ –≤–∂–µ –∑–Ω–∞—î—Ç–µ —É–º–æ–≤–∏ –∑–∞–≤–¥–∞–Ω–Ω—è. –í–∏—Å–≤—ñ—Ç–ª–∏–º–æ —ó—Ö –¥–æ–∫–ª–∞–¥–Ω—ñ—à–µ.

–í–∏ –ø—Ä–∞—Ü—é—î—Ç–µ –≤ –±—É–∫–º–µ–∫–µ—Ä—Å—å–∫—ñ–π –∫–æ–Ω—Ç–æ—Ä—ñ. –û–¥–Ω–µ –∑ –≤–∞—à–∏—Ö –∑–∞–≤–¥–∞–Ω—å ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö –¥–ª—è ML-–º–æ–¥–µ–ª–µ–π. –î–µ—è–∫—ñ –∑ features ‚Äî —Ü–µ —Å–µ—Ä–µ–¥–Ω—ñ–π –∑—Ä—ñ—Å—Ç, —Å–µ—Ä–µ–¥–Ω—è –≤–∞–≥–∞, —Å—Ç–∞—Ç—å, –∫—Ä–∞—ó–Ω–∞ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –∞—Ç–ª–µ—Ç—ñ–≤.

–ú–æ–¥–µ–ª—ñ —Ç—Ä–µ–Ω—É—é—Ç—å—Å—è –æ–∫—Ä–µ–º–æ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∏–¥—É —Å–ø–æ—Ä—Ç—É. –î–∞–Ω—ñ –ø—Ä–æ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –º–µ–¥–∞–ª—ñ —É –≤–∏—Å—Ç—É–ø—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —è–∫ target (output) –¥–ª—è ML-–º–æ–¥–µ–ª—ñ.

–§—ñ—Ä–º–∞ —Ö–æ—á–µ –∫–æ—Ä–∏–≥—É–≤–∞—Ç–∏ –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∏ —Å—Ç–∞–≤–æ–∫ —è–∫–æ–º–æ–≥–∞ —à–≤–∏–¥—à–µ, —Ç–æ–º—É –≤–∞—Å –ø–æ–ø—Ä–æ—Å–∏–ª–∏ —Ä–æ–∑—Ä–æ–±–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º —Å—Ç—Ä–∏–º—ñ–Ω–≥—É. –§—ñ–∑–∏—á–Ω—ñ –¥–∞–Ω—ñ –∞—Ç–ª–µ—Ç—ñ–≤ –≤—ñ–¥–æ–º—ñ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å —ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ MySQL –±–∞–∑—ñ –¥–∞–Ω–∏—Ö. –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–º–∞–≥–∞–Ω—å –∂–µ –ø–æ–¥–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ Kafka-—Ç–æ–ø—ñ–∫.

–í–∞—à–∞ –∑–∞–¥–∞—á–∞:

1. –ó—á–∏—Ç–∞—Ç–∏ –¥–∞–Ω—ñ —Ñ—ñ–∑–∏—á–Ω–∏—Ö –ø–æ–∫–∞–∑–Ω–∏–∫—ñ–≤ –∞—Ç–ª–µ—Ç—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Spark –∑ MySQL —Ç–∞–±–ª–∏—Ü—ñ `olympic_dataset.athlete_bio` (–±–∞–∑–∞ –¥–∞–Ω–∏—Ö —ñ Credentials –¥–æ –Ω–µ—ó –≤–∞–º –±—É–¥—É—Ç—å –Ω–∞–¥–∞–Ω—ñ).

2. –í—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ, –¥–µ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –∑—Ä–æ—Å—Ç—É —Ç–∞ –≤–∞–≥–∏ —î –ø–æ—Ä–æ–∂–Ω—ñ–º–∏ –∞–±–æ –Ω–µ —î —á–∏—Å–ª–∞–º–∏. –ú–æ–∂–Ω–∞ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏ –Ω–∞ –±—É–¥—å-—è–∫–æ–º—É –µ—Ç–∞–ø—ñ –≤–∞—à–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏.

3. –ó—á–∏—Ç–∞—Ç–∏ –¥–∞–Ω—ñ –∑ mysql —Ç–∞–±–ª–∏—Ü—ñ `athlete_event_results `—ñ –∑–∞–ø–∏—Å–∞—Ç–∏ –≤ –∫–∞—Ñ–∫–∞ —Ç–æ–ø—ñ–∫ `athlete_event_results`. –ó—á–∏—Ç–∞—Ç–∏ –¥–∞–Ω—ñ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∑–º–∞–≥–∞–Ω—å –∑ Kafka-—Ç–æ–ø—ñ–∫—É `athlete_event_results`. –î–∞–Ω—ñ –∑ json-—Ñ–æ—Ä–º–∞—Ç—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ dataframe-—Ñ–æ—Ä–º–∞—Ç, –¥–µ –∫–æ–∂–Ω–µ –ø–æ–ª–µ json —î –æ–∫—Ä–µ–º–æ—é –∫–æ–ª–æ–Ω–∫–æ—é.

4. –û–±‚Äô—î–¥–Ω–∞—Ç–∏ –¥–∞–Ω—ñ –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∑–º–∞–≥–∞–Ω—å –∑ Kafka-—Ç–æ–ø—ñ–∫—É –∑ –±—ñ–æ–ª–æ–≥—ñ—á–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏ –∑ MySQL —Ç–∞–±–ª–∏—Ü—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –∫–ª—é—á–∞ `athlete_id`.

5. –ó–Ω–∞–π—Ç–∏ —Å–µ—Ä–µ–¥–Ω—ñ–π –∑—Ä—ñ—Å—Ç —ñ –≤–∞–≥—É –∞—Ç–ª–µ—Ç—ñ–≤ —ñ–Ω–¥–∏–≤—ñ–¥—É–∞–ª—å–Ω–æ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤–∏–¥—É —Å–ø–æ—Ä—Ç—É, —Ç–∏–ø—É –º–µ–¥–∞–ª—ñ –∞–±–æ —ó—ó –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ, —Å—Ç–∞—Ç—ñ, –∫—Ä–∞—ó–Ω–∏ (`country_noc`). –î–æ–¥–∞–π—Ç–µ —Ç–∞–∫–æ–∂ timestamp, –∫–æ–ª–∏ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫–∏ –±—É–ª–∏ –∑—Ä–æ–±–ª–µ–Ω—ñ.

6. –ó—Ä–æ–±—ñ—Ç—å —Å—Ç—Ä–∏–º –¥–∞–Ω–∏—Ö (–∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Ñ—É–Ω–∫—Ü—ñ—ó `forEachBatch`) —É:

–∞) –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–∞—Ñ–∫–∞-—Ç–æ–ø—ñ–∫,

b) –±–∞–∑—É –¥–∞–Ω–∏—Ö.

–í–∏–≥–ª—è–¥ –≤–∏—Ö—ñ–¥–Ω–∏—Ö –¥–∞–Ω–∏—Ö –º–∞—î –±—É—Ç–∏ –ø—Ä–∏–±–ª–∏–∑–Ω–æ —Ç–∞–∫–∏–º:  
![alt text](md.media/t_01.png)